import glob
import os
import re
import difflib

ori_names = ["Papilio_Rutulus","Papilio_Zelicaon","Papilio_Indra","Papilio_Machaon","Parnassius_Smintheus",
        "Pieris_Rapae","Pontia_Protodice","Pontia_Occidentalis","Neophasia_Menapia","Euchloe_Ausonides",
        "Anthocharis_Julia","Colias_Philodice","Colias_Eurytheme","Colias_Christina","Celastrina_Ladon",
        "Plebejus_Melissa","Glaucopsyche_Lygdamus","Cupido_Amyntula","Plebejus_Acmon","Tharsalea_Rubidus",
        "Tharsalea_Heteronea","Lycaena_Hyllus","Tharsalea_Helloides","Polygonia_Satyrus","Nymphalis_Californica",
        "Hypaurotis_Crysalus","Strymon_Melinus","Satyrium_Sylvinus","Satyrium_Behrii","Callophrys_Gryneus",
        "Callophrys_Eryphon","Apodemia_Mormo","Nymphalis_Antiopa","Aglais_Milberti","Epargyreus_Clarus",
        "Thorybes_Pylades","Erynnis_Telemachus","Burnsius_Communis","Amblyscirtes_Vialis","Hesperia_Juba",
        "Ochlodes_Sylvanoides","Lon_Taxiles","Polites_Sabuleti","Vanessa_Atalanta","Vanessa_Cardui",
        "Junonia_Coenia","Chlosyne_Leanira","Chlosyne_Acastus","Euphydryas_Anicia","Phyciodes_Cocyta",
        "Phyciodes_Pulchella","Boloria_Kriemhild","Boloria_Selene","Adelpha_Eulalia","Limenitis_Weidemeyerii",
        "Limenitis_Archippus","Speyeria_Cybele","Speyeria_Coronis","Cercyonis_Pegala","Cercyonis_Pegala",
        "Papilio_Indra","Papilio_Zelicaon","Papilio_Polyxenes","Papilio_Machaon","Papilio_Machaon",
        "Papilio_Multicaudata","Papilio_Rutulus","Papilio_Eurymedon","Parnassius_Smintheus","Parnassius_Clodius",
        "Colias_Occidentalis","Colias_Eurytheme","Colias_Philodice","Colias_Alexandra","Colias_Meadii",
        "Colias_Scudderii","Nathalis_Iole","Neophasia_Menapia","Pontia_Occidentalis","Pontia_Protodice",
        "Pontia_Sisymbrii","Pontia_Beckerii","Pieris_Rapae","Pieris_Marginalis","Euchloe_Ausonides",
        "Euchloe_Lotta","Anthocharis_Julia","Anthocharis_Thoosa","Anthocharis_Cethura","Cercyonis_Sthenele",
        "Cercyonis_Oetus","Cercyonis_Meadii","Cercyonis_Pegala","Cercyonis_Pegala","Erebia_Epipsodea",
        "Erebia_Callias","Erebia_Magdalena","Coenonympha_California","Cyllopsis_Pertepida","Danaus_Gilippus",
        "Oeneis_Chryxus","Oeneis_Jutta","Oeneis_Bore","Oeneis_Melissa","Oeneis_Uhleri",
        "Neominois_Ridingsii"]


ori_names = ["Abaeis_mexicana",
            "Abaeis_nicippe",
            "Adelpha_eulalia",
            "Agathymus_alliae_paiute",
            "Aglais_milberti",
            "Aglais_milberti_subpallida",
            "Agriades_glandon",
            "Agriades_glandon_rustica",
            "Amblyscirtes",
            "Amblyscirtes_aenus",
            "Amblyscirtes_vialis",
            "Anthocharidini",
            "Anthocharis",
            "Anthocharis",
            "Anthocharis_cethura",
            "Anthocharis_cethura_mojavensis",
            "Anthocharis_cethura_pima",
            "Anthocharis_julia",
            "Anthocharis_julia_browningi",
            "Anthocharis_julia_sulfuris",
            "Anthocharis_thoosa",
            "Anthocharis_thoosa_thoosa",
            "Apodemia",
            "Apodemia",
            "Apodemia_mormo",
            "Apodemia_mormo_autumnalis",
            "Apodemia_mormo_parva",
            "Apodemia_palmerii_palmerii",
            "Argynnini",
            "Argynnis",
            "Argynnis_aphrodite",
            "Argynnis_callippe",
            "Argynnis_callippe_harmonia",
            "Argynnis_coronis",
            "Argynnis_coronis_snyderi",
            "Argynnis_cybele",
            "Argynnis_cybele_charlottii",
            "Argynnis_cybele_krautwurmi",
            "Argynnis_cybele_leto",
            "Argynnis_cybele_letona",
            "Argynnis_egleis",
            "Argynnis_egleis_utahensis",
            "Argynnis_hesperis",
            "Argynnis_hesperis_chitone",
            "Argynnis_hesperis_tetonia",
            "Argynnis_hydaspe",
            "Argynnis_hydaspe_rhodope",
            "Argynnis_mormonia",
            "Argynnis_mormonia_eurynome",
            "Argynnis_nokomis",
            "Argynnis_nokomis_apacheana",
            "Argynnis_nokomis_nokomis",
            "Argynnis_zerene",
            "Argynnis_zerene_picta",
            "Argynnis_zerene_platina",
            "Asterocampa_celtis",
            "Atalopedes",
            "Atlides_halesus",
            "Atlides_halesus_corcorani",
            "Battus_philenor",
            "Boloria",
            "Boloria_chariclea",
            "Boloria_chariclea_helena",
            "Boloria_freija_browni",
            "Boloria_kriemhild",
            "Boloria_myrina",
            "Boloria_selene",
            "Brephidium",
            "Brephidium_exilis",
            "Brephidium_exilis_exilis",
            "Burnsius",
            "Burnsius_albezens",
            "Burnsius_communis",
            "Callophryidina",
            "Callophrys",
            "Callophrys_affinis",
            "Callophrys_affinis_affinis",
            "Callophrys_affinis_homoperplexa",
            "Callophrys_augustinus",
            "Callophrys_augustinus_annetteae",
            "Callophrys_augustinus_concava",
            "callophrys_eryphon",
            "Callophrys_eryphon_eryphon",
            "Callophrys_fotis",
            "Callophrys_gryneus",
            "Callophrys_gryneus_chalcosiva",
            "Callophrys_gryneus_siva",
            "Callophrys_polios_obscurus",
            "Callophrys_sheridanii",
            "Callophrys_sheridanii_neoperplexa",
            "Callophrys_sheridanii_paradoxa",
            "Callophrys_spinetorum",
            "Celastrina",
            "Celastrina_echo",
            "Celastrina_echo_cinerea",
            "Celastrina_echo_echo",
            "Celastrina_echo_sidara",
            "Celestrina_ladon",
            "Cercyonis",
            "Cercyonis_meadii",
            "Cercyonis_meadii_meadii",
            "Cercyonis_oetus",
            "Cercyonis_oetus_charon",
            "Cercyonis_oetus_oetus",
            "Cercyonis_pegala",
            "Cercyonis_pegala_paludum",
            "Cercyonis_pegala_utahensis",
            "Cercyonis_sthenele",
            "Cercyonis_sthenele_masoni",
            "Chlorostrymon_simaethis",
            "Chlorostrymon_simaethis_sarita",
            "Chlosyne",
            "Chlosyne_acastus",
            "Chlosyne_acastus_acastus",
            "Chlosyne_acastus_neumoegeni",
            "Chlosyne_californica",
            "Chlosyne_coronado_pariaensis",
            "Chlosyne_damoetas",
            "Chlosyne_gorgone",
            "Chlosyne_lacinia_crocale",
            "Chlosyne_leanira",
            "Chlosyne_leanira_alma",
            "Chlosyne_leanira_flavodorsalis",
            "Chlosyne_palla",
            "Chlosyne_palla_flavula",
            "Clossiana",
            "Coenonympha_california",
            "Coenonympha_california_elko",
            "Coenonympha_california_ochracea",
            "Coenonympha_california_pseudobrenda",
            "Coliadinae",
            "Colias",
            "Colias_alexandra",
            "Colias_alexandra_alexandra",
            "Colias_alexandra_edwardsii",
            "Colias_christina",
            "Colias_eurytheme",
            "Colias_meadii",
            "Colias_meadii_meadii",
            "Colias_occidentalis",
            "Colias_occidentalis_pseudochristina",
            "Colias_philodice",
            "Colias_scudderi_",
            "Copaeodes_aurantiaca",
            "Cupido",
            "Cupido_amyntula",
            "Cupido_amyntula_amyntula",
            "Cyllopsis_pertepida",
            "Cyllopsis_pertepida_dorothea",
            "Danaus",
            "Danaus_gilippus",
            "Danaus_gilippus_thersippus",
            "Danaus_plexippus",
            "Danaus_plexippus_plexippus",
            "Echinargus_isola",
            "Epargyreus_clarus",
            "Epargyreus_clarus_clarus",
            "Epidemia",
            "Erebia_callias",
            "Erebia_epipsodea",
            "Erebia_magdalena",
            "Erebia_magdalena_magdalena",
            "Erynnini",
            "Erynnis",
            "Erynnis_afranius",
            "Erynnis_brizo",
            "Erynnis_brizo_burgessi",
            "Erynnis_funeralis",
            "Erynnis_horatius",
            "Erynnis_icelus",
            "Erynnis_meridianus",
            "Erynnis_pacuvius",
            "Erynnis_pacuvius_lilius",
            "Erynnis_pacuvius_pacuvius",
            "Erynnis_persius",
            "Erynnis_persius_fredericki",
            "Erynnis_propertius",
            "Erynnis_telemachus",
            "Euchloe",
            "Euchloe_ausonides",
            "Euchloe_ausonides_coloradensis",
            "Euchloe_lotta",
            "Eudaminae",
            "Eumaeini",
            "Euphilotes",
            "Euphilotes_ancilla",
            "Euphilotes_ancilla_ancilla",
            "Euphilotes_baueri",
            "Euphilotes_ellisii",
            "Euphilotes_ellisii_ellisi",
            "Euphilotes_enoptes",
            "Euphilotes_pallescens",
            "Euphilotes_pallescens_emmeli",
            "Euphilotes_pallescens_pallescens",
            "Euphilotes_spaldingi",
            "Euphilotes_spaldingi_spaldingi",
            "Euphilotes_stanfordorum",
            "Euphydryas",
            "Euphydryas_anicia",
            "Euphydryas_anicia_alena",
            "Euphydryas_anicia_hermosa",
            "Euphydryas_anicia_maria",
            "Euphydryas_anicia_wecoeut",
            "Euphydryas_anicia_wheeleri",
            "Euphydryas_colon_nevadensis",
            "Euphydryas_editha",
            "Euphydryas_editha_lehmani",
            "Euphyes_vestris",
            "Euphyes_vestris_kiowah",
            "Euptoieta",
            "Euptoieta_claudia",
            "Glaucopsyche",
            "Glaucopsyche_lygdamus",
            "Glaucopsyche_lygdamus_minipunctum",
            "Glaucopsyche_lygdamus_oro",
            "Glaucopsyche_piasus",
            "Glaucopsyche_piasus_daunia",
            "Greenie",
            "Hamadryas_februa",
            "Heliconiinae",
            "Heliopetes",
            "Heliopetes_ericetorum",
            "Hemiargus_ceraunus",
            "Hemiargus_ceraunus_gyas",
            "Heraclides",
            "Hesperia",
            "Hesperia_colorado",
            "Hesperia_colorado_idaho",
            "Hesperia_juba",
            "Hesperia_leonardus",
            "Hesperia_nevada",
            "Hesperia_nevada_nevada",
            "Hesperia_pahaska",
            "Hesperia_pahaska_martini",
            "Hesperia_uncas",
            "Hesperia_uncas_lasus",
            "Hesperiidae",
            "Hesperiina",
            "Hesperiinae",
            "Hesperiini",
            "Hesperopsis_alpheus",
            "Hesperopsis_alpheus_oricus",
            "Hesperopsis_libya",
            "Hesperopsis_libya_confertiblanca",
            "Hesperopsis_libya_libya",
            "Hylephila_phyleus",
            "Hylephila_phyleus_phyleus",
            "Hypaurotis_crysalus",
            "Hypaurotis_crysalus_citima",
            "Hypaurotis_crysalus_intermedia",
            "Icaricia",
            "Icaricia_icarioides",
            "Icaricia_icarioides_lycea",
            "Icaricia_lupini",
            "Icaricia_lupini_lutzi",
            "Icaricia_lupini_texanus",
            "Icaricia_saepiolus",
            "Icaricia_saepiolus_gertschi",
            "Icaricia_saepiolus_whitmeri",
            "Icaricia_shasta",
            "Icaricia_shasta_minnehaha",
            "Junonia_coenia",
            "Junonia_grisea",
            "Leptotes",
            "Leptotes_marina",
            "Lerodea_eufala",
            "Libytheana_carinenta",
            "Limenitis_archippus",
            "Limenitis_archippus_archippus",
            "Limenitis_archippus_lahontani",
            "Limenitis_archippus_obsoleta",
            "Limenitis_weidemeyerii",
            "Limenitis_weidemeyerii_angustifascia",
            "Limenitis_weidemeyerii_latifascia",
            "Limenitis_weidemeyerii_weidemeyerii",
            "Lon",
            "Lon_taxiles",
            "Lycaeides",
            "Lycaena",
            "Lycaena_cupreus",
            "Lycaena_cupreus_cupreus",
            "Lycaena_hyllus",
            "Lycaenidae",
            "Lycaeninae",
            "Lycaenini",
            "Megathymus_streckeri",
            "Megathymus_yuccae",
            "Megathymus_yuccae_navajo",
            "Melitaeini",
            "Nathalis_iole",
            "Nathalis_iole_iole",
            "Neominois_ridingsii",
            "Neominois_ridingsii_coloalbiterra",
            "Neominois_ridingsii_stretchii",
            "Neominois_ridingsii_wyomingo",
            "Neophasia_menapia",
            "Neophasia_menapia_magnamenapia",
            "Nymphalidae",
            "Nymphalinae",
            "Nymphalini",
            "Nymphalis_antiopa",
            "Nymphalis_californica",
            "Nymphalis_l-album",
            "Oarisma_garita",
            "Oarisma_garita_garita",
            "Ochlodes",
            "Ochlodes_sylvanoides",
            "Ochlodes_sylvanoides_omnigena",
            "Ochlodes_yuma",
            "Ochlodes_yuma_scudderi",
            "Ochlodes_yuma_yuma",
            "Oeneis_bore",
            "Oeneis_bore_edwardsi",
            "Oeneis_chryxus",
            "Oeneis_chryxus_chryxus",
            "Oeneis_jutta",
            "Oeneis_jutta_reducta",
            "Oeneis_melissa",
            "Oeneis_melissa_beanii",
            "Oeneis_uhleri",
            "Papilio",
            "Papilio",
            "Papilio_bairdii",
            "Papilio_bairdii_bairdii",
            "Papilio_eurymedon",
            "Papilio_indra",
            "Papilio_indra_calcicola",
            "Papilio_indra_indra",
            "Papilio_machaon",
            "Papilio_multicaudata",
            "Papilio_multicaudata_multicaudata",
            "Papilio_multicaudata_pusillus",
            "Papilio_polyxenes",
            "Papilio_polyxenes_rudkini",
            "Papilio_rutulus",
            "Papilio_zelicaon",
            "Papilio_zelicaon_nitra",
            "Papilioninae",
            "Papilionoidea",
            "Parnassius",
            "Parnassius_clodius",
            "Parnassius_clodius_menetriesii",
            "Parnassius_smintheus",
            "Parnassius_smintheus_sayii",
            "Phoebis_sennae",
            "Pholisora",
            "Pholisora_catullus",
            "Phyciodes",
            "Phyciodes_batesii",
            "Phyciodes_batesii_anasazi",
            "Phyciodes_cocyta",
            "Phyciodes_cocyta_cocyta",
            "Phyciodes_cocyta_selenis",
            "Phyciodes_mylitta",
            "Phyciodes_mylitta_arizonensis",
            "Phyciodes_mylitta_mylitta",
            "Phyciodes_pallida",
            "Phyciodes_pallida_barnesi",
            "Phyciodes_picta",
            "Phyciodes_picta_picta",
            "Phyciodes_pulchella",
            "Phyciodes_pulchella_camillus",
            "Phyciodes_tharos",
            "Phyciodes_tharos_riocolorado",
            "Pieridae",
            "Pierina",
            "Pierinae",
            "Pierini",
            "Pieris",
            "Pieris_marginalis",
            "Pieris_marginalis_pallidissima",
            "Pieris_rapae",
            "Piruna",
            "Piruna_pirus",
            "Plebejus_acmon",
            "Plebejus_idas",
            "Plebejus_melissa",
            "Plebejus_melissa_annetta",
            "Plebejus_melissa_melissa",
            "Poladryas_arachne",
            "Poladryas_arachne_arachne",
            "Poladryas_arachne_expedita",
            "Polites",
            "Polites_draco",
            "Polites_sabuleti",
            "Polites_sabuleti_alkaliensis",
            "Polites_sonora",
            "Polites_sonora_utahensis",
            "Polites_themistocles",
            "Polygonia",
            "Polygonia_faunus",
            "Polygonia_faunus_hylas",
            "Polygonia_gracilis",
            "Polygonia_gracilis_zephyrus",
            "Polygonia_interrogationis",
            "Polygonia_oreas",
            "Polygonia_oreas_satellow",
            "Polygonia_satyrus",
            "Polygonia_satyrus_satyrus",
            "Polyommatina",
            "Polyommatinae",
            "Polyommatini",
            "Pontia",
            "Pontia_beckerii",
            "Pontia_occidentalis",
            "Pontia_occidentalis_occidentalis",
            "Pontia_protodice",
            "Pontia_sisymbrii",
            "Pontia_sisymbrii_elivata",
            "Pontia_sisymbrii_nigravenosa",
            "Pterourus",
            "Pyrginae",
            "Pyrgini",
            "Pyrgus",
            "Pyrgus_centaureae",
            "Pyrgus_centaureae_loki",
            "Pyrgus_ruralis",
            "Pyrgus_scriptura",
            "Pyrgus_scriptura_apertorum",
            "Pyrisitia_lisa",
            "Satyrinae",
            "Satyrini",
            "Satyrium",
            "Satyrium_behrii",
            "Satyrium_behrii_behrii",
            "Satyrium_calanus",
            "Satyrium_californica",
            "Satyrium_californica_obscurafacies",
            "Satyrium_saepium",
            "Satyrium_saepium_latalinea",
            "Satyrium_saepium_provo",
            "Satyrium_semiluna",
            "Satyrium_semiluna_semiluna",
            "Satyrium_sylvinus",
            "Satyrium_sylvinus_putnami",
            "Satyrium_titus",
            "Satyrium_titus_immaculosus",
            "Scolitantidina",
            "Speyeria_callippe",
            "Speyeria_coronis",
            "Speyeria_cybele",
            "Speyeria_egleis",
            "Speyeria_hesperis",
            "Speyeria_hydaspe",
            "Speyeria_mormonia",
            "Speyeria_zerene",
            "Strymon_melinus",
            "Strymon_melinus_franki",
            "Systasea_zampa",
            "Tharsalea",
            "Tharsalea_arota",
            "Tharsalea_arota_schellbachi",
            "Tharsalea_dorcas",
            "Tharsalea_dorcas_sangremar",
            "Tharsalea_editha",
            "Tharsalea_editha_montana",
            "Tharsalea_editha_vurali",
            "Tharsalea_helloides",
            "Tharsalea_heteronea",
            "Tharsalea_heteronea_gravenotata",
            "Tharsalea_heteronea_heteronea",
            "Tharsalea_heteronea_rava",
            "Tharsalea_hyllus",
            "Tharsalea_nivalis",
            "Tharsalea_nivalis_browni",
            "Tharsalea_rubidus",
            "Tharsalea_rubidus_sirius",
            "Thorybes",
            "Thorybes_nevada",
            "Thorybes_pylades",
            "Thorybes_pylades_pylades",
            "Thymelicus",
            "Thymelicus_lineola",
            "Vanessa",
            "Vanessa_annabella",
            "Vanessa_atalanta",
            "Vanessa_atalanta_rubria",
            "Vanessa_cardui",
            "Vanessa_virginiensis",
            "Zerene_cesonia"]
names = []
for i in ori_names:
    names.append(i.lower())


#names = set(names)
folder_path = "/multiview/datasets/inat-butterflies-new/download_images/*"

folder_list = glob.glob(folder_path)
compare_list = []
compare_list2 = []
for i in folder_list:
    compare_list.append(os.path.basename(i).lower())
    compare_list2.append(i)


match_list = []
"""
for i in names:
    same = i in compare_list
    match_list.append(same)
    if same != True:
        temp = []
        for j in compare_list:
            r = difflib.SequenceMatcher(None, i, j).ratio()
            if r > 0.8:
                temp.append(j)
        if len(temp) > 0:
            print(i)
            print(temp)
"""
for i in compare_list:
    same = i in names
    match_list.append(same)

f = open("inat_nonUT.txt", "w")
for num,i in enumerate(compare_list):
    if match_list[num] == False:
        
        index = compare_list.index(i)
        img_num = len(glob.glob(compare_list2[index] + "/adults/*"))
        img_num2 = len(glob.glob(compare_list2[index] + "/*.jpg"))
        f.write(str(i) + "," + str(img_num) + "," + str(img_num2)+ "\n")
        #print(i,",",img_num,",",img_num2)
f.close()
"""
for i in names:
    same = i in compare_list
    if same == True:
        index = compare_list.index(i)
        img_num = len(glob.glob(compare_list2[index] + "/adults/*"))
        img_num2 = len(glob.glob(compare_list2[index] + "/*.jpg"))
        print(i,",",img_num,",",img_num2)
    else:
        print(i,",",0,",",0)
"""


